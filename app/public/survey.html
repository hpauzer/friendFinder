<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Survey</title>

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
    <script src="https://code.jquery.com/jquery.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>

</head>

<body id="surveyBody">

    <div class="container">
        <h1 class="display-3" id="surveyHeader">Survey Questions</h1>
        <hr class="my-2">
        <h2 class="display-3">About You</h2>

        <form>
            <div class="form-group">
                <label for="formGroupExampleInput">Name (Required)</label>
                <input type="text" class="form-control" id="friendName" placeholder="">
            </div>
            <!-- close Name input -->

            <div class="form-group">
                <label for="formGroupExampleInput2">Link to Photo Image (Required)</label>
                <input type="text" class="form-control" id="friendPic" placeholder="">
            </div>
            <!-- close Photo Link input -->
        </form>


        <h4>1. You find it difficult to introduce yourself to other people.<br></h4>
        <select class="custom-select" id="q1value">
            <option selected>Select an Option...</option>
            <option value="1">1 (Strongly Disagree)</option>
            <option value="2">2 (Disagree)</option>
            <option value="3">3 (Neutral)</option>
            <option value="4">4 (Agree)</option>
            <option value="5">5 (Strongly Agree)</option>
            </select>
        <br><br>

        <h4>2. You often get so lost in thoughts that you ignore or forget your surroundings.<br></h4>
        <select class="custom-select" id="q2value">
            <option selected>Select an Option...</option>
            <option value="1">1 (Strongly Disagree)</option>
            <option value="2">2 (Disagree)</option>
            <option value="3">3 (Neutral)</option>
            <option value="4">4 (Agree)</option>
            <option value="5">5 (Strongly Agree)</option>
            </select>

        <br><br>


        <h4>3. You do not usually initiate conversations.<br></h4>
        <select class="custom-select" id="q3value">
            <option selected>Select an Option...</option>
            <option value="1">1 (Strongly Disagree)</option>
            <option value="2">2 (Disagree)</option>
            <option value="3">3 (Neutral)</option>
            <option value="4">4 (Agree)</option>
            <option value="5">5 (Strongly Agree)</option>
            </select>
        <br><br>


        <h4>4. Being organized is more important to you than being adaptable.<br></h4>
        <select class="custom-select" id="q4value">
            <option selected>Select an Option...</option>
            <option value="1">1 (Strongly Disagree)</option>
            <option value="2">2 (Disagree)</option>
            <option value="3">3 (Neutral)</option>
            <option value="4">4 (Agree)</option>
            <option value="5">5 (Strongly Agree)</option>
            </select>

        <br><br>


        <h4>5. You feel superior to other people.<br> </h4>
        <select class="custom-select" id="q5value">
            <option selected>Select an Option...</option>
            <option value="1">1 (Strongly Disagree)</option>
            <option value="2">2 (Disagree)</option>
            <option value="3">3 (Neutral)</option>
            <option value="4">4 (Agree)</option>
            <option value="5">5 (Strongly Agree)</option>
            </select>
        <br><br>

        <h4>6. You are usually highly motivated and energetic.<br></h4>
        <select class="custom-select" id="q6value">
            <option selected>Select an Option...</option>
            <option value="1">1 (Strongly Disagree)</option>
            <option value="2">2 (Disagree)</option>
            <option value="3">3 (Neutral)</option>
            <option value="4">4 (Agree)</option>
            <option value="5">5 (Strongly Agree)</option>
            </select>
        <br><br>

        <h4>7. Winning a debate matters less to you than making sure no one gets upset.<br></h4>
        <select class="custom-select" id="q7value">
            <option selected>Select an Option...</option>
            <option value="1">1 (Strongly Disagree)</option>
            <option value="2">2 (Disagree)</option>
            <option value="3">3 (Neutral)</option>
            <option value="4">4 (Agree)</option>
            <option value="5">5 (Strongly Agree)</option>
            </select>
        <br><br>


        <h4>8. You often feel as if you have to justify yourself to other people.<br></h4>
        <select class="custom-select" id="q8value">
            <option selected>Select an Option...</option>
            <option value="1">1 (Strongly Disagree)</option>
            <option value="2">2 (Disagree)</option>
            <option value="3">3 (Neutral)</option>
            <option value="4">4 (Agree)</option>
            <option value="5">5 (Strongly Agree)</option>
            </select>
        <br><br>


        <h4>9. Your home and work environments are quite tidy.<br></h4>
        <select class="custom-select" id="q9value">
            <option selected>Select an Option...</option>
            <option value="1">1 (Strongly Disagree)</option>
            <option value="2">2 (Disagree)</option>
            <option value="3">3 (Neutral)</option>
            <option value="4">4 (Agree)</option>
            <option value="5">5 (Strongly Agree)</option>
             
            </select>
        <br><br>


        <h4>10. You consider yourself more practical than creative.<br></h4>
        <select class="custom-select" id="q10value">
              <option selected>Select an Option...</option>
              <option value="1">1 (Strongly Disagree)</option>
              <option value="2">2 (Disagree)</option>
              <option value="3">3 (Neutral)</option>
              <option value="4">4 (Agree)</option>
              <option value="5">5 (Strongly Agree)</option>
            </select>
        <hr>
        <br><br>
        <button type="submit" class="btn btn-primary btn-lg btn-block" id="submit" data-toggle="modal" data-target="#friendModal">Submit</button>
        <br>
        <br>
        <div class="modal fade" id="friendModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h2 class="modal-title" id="exampleModalLabel">You're going to be great friends!</h2>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                      </button>
                    </div>
                    <div class="modal-body">

                        <h3 id="trueFriendName"></h3>

                        <img id="img" src="">

                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal" id="closeModal"><a href="/survey">Close</button>
                    </div>
                </div>
            </div>
        </div>

        <footer>
            <div class="container">
                <p><a href="">API Friends List</a> | <a href="">GitHub Repo</a></p>
            </div>
        </footer>
    </div>


</body>

</html>

<script type="text/javascript">
    var newFriend;
    var scores;
    var newFriendScores;
    var add = [];
    var allScores = [];
    var counter = 0;
    var sumArray = [];

    $("#submit").on("click", function() {
        event.preventDefault();

        scores = [];

        newFriend = {
            name: $("#friendName").val().trim(),
            link: $("#friendPic").val().trim(),
            responses: scores
        };

        var questionOne = parseInt($("#q1value").val());
        var questionTwo = parseInt($("#q2value").val());
        var questionThree = parseInt($("#q3value").val());
        var questionFour = parseInt($("#q4value").val());
        var questionFive = parseInt($("#q5value").val());
        var questionSix = parseInt($("#q6value").val());
        var questionSeven = parseInt($("#q7value").val());
        var questionEight = parseInt($("#q8value").val());
        var questionNine = parseInt($("#q9value").val());
        var questionTen = parseInt($("#q10value").val());


        scores.push(questionOne);
        scores.push(questionTwo);
        scores.push(questionThree);
        scores.push(questionFour);
        scores.push(questionFive);
        scores.push(questionSix);
        scores.push(questionSeven);
        scores.push(questionEight);
        scores.push(questionNine);
        scores.push(questionTen);

        console.log(newFriend);

        newFriendScores = newFriend.responses;
        console.log(newFriendScores)


        getFriends();



    });

    $("#closeModal").on("click", function() {

        $("#friendName").val("");
        $("#friendPic").val("");
        $(".custom-select").val("Select an Option...");

        add = [];
        sum = 0;
        startingSum = 100;
        allScores = [];

        $.post("/api/friends", newFriend, function(data) {});

    });

    function getFriends() {

        var currentURL = window.location.origin;

        $.ajax({
                url: currentURL + "/api/friends",
                method: "GET"
            })
            .done(function(friendsArray) {

                console.log("------------------------------------");
                console.log("URL: " + currentURL + "/api/friends");
                console.log("------------------------------------");

                console.log(friendsArray);
                console.log("------------------------------------");

                console.log(newFriendScores);

                //get the score from each index of the array
                for (var j = 0; j < friendsArray.length; j++) {
                    add = [];
                    sum = 0;
                    startingSum = 100;

                    var responses = friendsArray[j].responses;
                    allScores.push(responses);

                    console.log(allScores);

                    var currentFriend = allScores[j]

                    //Compare friend's scores with 90210 friends
                    for (var i = 0; i < 10; i++) {

                        var newFriendIndex = newFriendScores[i];
                        var currentFriendIndex = currentFriend[i];
                        var difference = Math.abs(newFriendIndex - currentFriendIndex);
                        add.push(difference);


                    }


                    //Add differences to determine a match
                    sum = add.reduce(function(a, b) {
                        return a + b;
                    }, 0);

                    console.log(sum);

                    if (sum < startingSum) {
                        startingSum = sum;

                        trueFriend = {
                            friendName: friendsArray[j].name,
                            friendPhoto: friendsArray[j].link
                        };


                    }


                }


                $("#trueFriendName").text(trueFriend.friendName);

                var friendpic = trueFriend.friendPhoto;
                $("#img").attr("src", friendpic);
                console.log(trueFriend);

            });

    }
</script>